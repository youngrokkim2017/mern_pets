(()=>{var e={860:e=>{"use strict";e.exports=require("express")},470:e=>{"use strict";e.exports=require("fs-extra")},13:e=>{"use strict";e.exports=require("mongodb")},738:e=>{"use strict";e.exports=require("multer")},109:e=>{"use strict";e.exports=require("sanitize-html")},441:e=>{"use strict";e.exports=require("sharp")},17:e=>{"use strict";e.exports=require("path")}},t={};function s(o){var n=t[o];if(void 0!==n)return n.exports;var i=t[o]={exports:{}};return e[o](i,i.exports,s),i.exports}(()=>{const e=s(860),{MongoClient:t,ObjectId:o}=s(13),n=s(738)(),i=s(109),a=s(470),r=(s(441),s(17));let c;a.ensureDirSync(r.join("public","uploaded-photos"));const l=e();l.set("view engine","ejs"),l.set("views","./views"),l.use(e.static("public")),l.use(e.json()),l.use(e.urlencoded({extended:!1})),l.get("/",(async(e,t)=>{const s=await c.collection("animals").find().toArray();console.log(s),t.render("home",{allAnimals:s})})),l.use((function(e,t,s){t.set("WWW-Authenticate","Basic realm='Our MERN App'"),"Basic YWRtaW46YWRtaW4="==e.headers.authorization?s():(console.log(e.headers.authorization),t.status(401).send("try again"))})),l.get("/admin",((e,t)=>{t.render("admin")})),l.get("/api/animals",(async(e,t)=>{const s=await c.collection("animals").find().toArray();t.json(s)})),l.post("/create-animal",n.single("photo"),(function(e,t,s){"string"!=typeof e.body.name&&(e.body.name=""),"string"!=typeof e.body.species&&(e.body.species=""),"string"!=typeof e.body._id&&(e.body._id=""),e.cleanData={name:i(rew.body.name.trim(),{allowedTags:[],allowedAttributes:{}}),species:i(rew.body.species.trim(),{allowedTags:[],allowedAttributes:{}})}}),(async(e,t)=>{console.log(e.body);const s=await c.collection("animals").insertOne(e.cleanData),n=await c.collection("animals").findOne({_id:new o(s.insertedId)});t.send(n)})),async function(){const e=new t("mongodb://root:root@localhost:27017/MernApp?&authSource=admin");await e.connect(),c=e.db(),l.listen(3e3)}()})()})();